<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>My Docs</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect fill='%234a90e2' width='100' height='100'/><text x='50' y='60' font-size='60' font-weight='bold' text-anchor='middle' fill='white'>üìö</text></svg>">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/docsify/themes/vue.css">
</head>
<body>
  <div id="app"></div>
  <script>
    window.$docsify = {
      name: 'Projects',
      loadSidebar: true,
      cache: false,
      mermaid: true
    };
  </script>

<script src="https://cdn.jsdelivr.net/npm/pako@2.1.0/dist/pako.min.js"></script>

<script>
(function () {
  // Fixed encoding function - the key issue was here
  function uint8ToBase64(u8) {
    return btoa(String.fromCharCode.apply(null, u8));
  }

  function mermaidLiveEditUrl(code) {
  // Simple base64 encoding without compression
  const encoded = btoa(unescape(encodeURIComponent(code.trim())));
  return `https://mermaid.live/edit#base64:${encoded}`;
}


  window.$docsify = window.$docsify || {};
  window.$docsify.markdown = window.$docsify.markdown || {};
  window.$docsify.markdown.renderer = window.$docsify.markdown.renderer || {};

  const previousCodeRenderer = window.$docsify.markdown.renderer.code;

  window.$docsify.markdown.renderer.code = function (code, lang) {
    const language = (lang || '').toLowerCase();

    if (language === 'mermaid') {
      const source = (code || '').trim();
      
      // Skip empty diagrams
      if (!source) {
        return '<div class="mermaid-error">Empty Mermaid diagram</div>';
      }

      const url = mermaidLiveEditUrl(source);

      return (
        '<div class="mermaid">' + source + '</div>' +
        '<div class="mermaid-live-link" style="margin: 0.5em 0; text-align: right;">' +
          '<a href="' + url + '" target="_blank" rel="noopener" style="font-size: 0.85em; color: #666; text-decoration: none; border: 1px solid #ddd; padding: 2px 8px; border-radius: 3px;">' +
            'üìù Edit in Mermaid Live' +
          '</a>' +
        '</div>'
      );
    }

    if (typeof previousCodeRenderer === 'function') {
      return previousCodeRenderer.call(this, code, lang);
    }

    return '<pre><code>' + code + '</code></pre>';
  };
})();
</script>

<script src="//cdn.jsdelivr.net/npm/docsify/lib/docsify.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/docsify-mermaid/dist/docsify-mermaid.min.js"></script>

<script>
  mermaid.initialize({ 
    startOnLoad: true,
    theme: 'default',
    securityLevel: 'loose'
  });
</script>
</body>
</html>
